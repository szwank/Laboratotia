<!-- saved from url=(0014)about:internet -->
<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T1U3">xHat</span>, <span class="var type1" id="S3T2U4">P</span>] = fcn(<span class="var type1" id="S4T1U7">t</span>, <span class="var type1" id="S5T1U8">u1</span>, <span class="var type1" id="S6T1U9">u2</span>, <span class="var type1" id="S7T3U10">y</span> , <span class="var type1" id="S2T1U11">xHat</span>, <span class="var type1" id="S8T2U12">Pk</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line"><span class="mxinfo " id="T2:U9"><span class="var type1" id="S9T2U15">Ad</span> = <span class="mxinfo " id="T2:U11">[1 0 0.01 0; 0 1 0 0.01; 0 0 1 0; 0 0 0 1]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line"><span class="mxinfo " id="T4:U12"><span class="var type1" id="S10T4U39">Bd</span> = <span class="mxinfo " id="T4:U14">[0.0001 0;0 0.0001;0.01 0;0 0.01]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line"><span class="mxinfo " id="T5:U15"><span class="var type1" id="S11T5U55">Cd</span> = <span class="mxinfo " id="T5:U17">[1 0 0 0; 0 1 0 0]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line"><span class="mxinfo " id="T2:U18"><span class="var type1" id="S12T2U69">G</span> = <span class="mxinfo " id="T2:U20">zeros(<span class="mxinfo " id="T1:U21">4</span>,<span class="mxinfo " id="T1:U22">4</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line"><span class="mxinfo " id="T2:U23"><span class="var type1" id="S14T2U76">Z</span> = <span class="mxinfo " id="T2:U25">zeros(<span class="mxinfo " id="T1:U26">4</span>,<span class="mxinfo " id="T1:U27">4</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line"><span class="mxinfo " id="T6:U28"><span class="var type1" id="S15T6U83">V</span> = <span class="mxinfo " id="T6:U30">zeros(<span class="mxinfo " id="T1:U31">2</span>,<span class="mxinfo " id="T1:U32">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">10</a></span><span class="line"><span class="mxinfo " id="T3:U33"><span class="var type1" id="S16T3U90">u</span> = <span class="mxinfo " id="T3:U35">[<span class="var type1" id="S5T1U93">u1</span>;<span class="var type1" id="S6T1U95">u2</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">11</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">12</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T7:U38"><span class="var type1" id="S4T1U99">t</span> == <span class="mxinfo " id="T1:U40">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13">13</a></span><span class="line">  <span class="mxinfo " id="T8:U41"><span class="var type1" id="S17T8U103">x</span> = <span class="mxinfo " id="T8:U43">[pi/2; 0; 0; 0;]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14">14</a></span><span class="line">    <span class="mxinfo " id="T2:U44"><span class="var type1" id="S19T2U118">Pk0</span> = <span class="mxinfo " id="T2:U46"><span class="var type1" id="S17T8U120">x</span> * <span class="var type1" id="S17T8U122">x</span>'</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15">15</a></span><span class="line">    <span class="mxinfo " id="T8:U49"><span class="var type1" id="S20T8U125">xHat_kk1</span> = <span class="mxinfo " id="T8:U51"><span class="mxinfo " id="T8:U52"><span class="var type1" id="S9T2U128">Ad</span> * <span class="var type1" id="S17T8U129">x</span></span> + <span class="mxinfo " id="T8:U55"><span class="var type1" id="S10T4U131">Bd</span> * <span class="var type1" id="S16T3U132">u</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16">16</a></span><span class="line">    <span class="mxinfo " id="T2:U58"><span class="var type1" id="S21T2U135">P_kk1</span> = <span class="mxinfo " id="T2:U60"><span class="var type1" id="S9T2U139">Ad</span> * <span class="var type1" id="S19T2U140">Pk0</span> * <span class="var type1" id="S9T2U142">Ad</span>' + <span class="var type1" id="S12T2U145">G</span> * <span class="var type1" id="S14T2U146">Z</span> * <span class="var type1" id="S12T2U148">G</span>'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17">17</a></span><span class="line">    <span class="mxinfo " id="T4:U67"><span class="var type1" id="S22T4U151">K</span> = <span class="mxinfo " id="T4:U69"><span class="mxinfo " id="T4:U70"><span class="var type1" id="S21T2U154">P_kk1</span> * <span class="var type1" id="S11T5U156">Cd</span>'</span> * <span class="mxinfo " id="T6:U73">inv(<span class="var type1" id="S11T5U162">Cd</span> * <span class="var type1" id="S21T2U163">P_kk1</span> * <span class="var type1" id="S11T5U165">Cd</span>' + <span class="var type1" id="S15T6U166">V</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18">18</a></span><span class="line">    <span class="mxinfo " id="T2:U78"><span class="var type1" id="S3T2U169">P</span> = <span class="mxinfo " id="T2:U80"><span class="mxinfo " id="T2:U81"><span class="mxinfo " id="T2:U82">(<span class="mxinfo " id="T2:U83"><span class="mxinfo " id="T2:U84">eye(4)</span> - <span class="mxinfo " id="T2:U85"><span class="var type1" id="S22T4U179">K</span> * <span class="var type1" id="S11T5U180">Cd</span></span></span>) * <span class="var type1" id="S21T2U181">P_kk1</span></span> * <span class="mxinfo " id="T2:U89">(<span class="mxinfo " id="T2:U90"><span class="mxinfo " id="T2:U91">eye(4)</span> - <span class="mxinfo " id="T2:U92"><span class="var type1" id="S22T4U189">K</span> * <span class="var type1" id="S11T5U190">Cd</span></span></span>)'</span></span> + <span class="mxinfo " id="T2:U95"><span class="mxinfo " id="T4:U96"><span class="var type1" id="S22T4U193">K</span> * <span class="var type1" id="S15T6U194">V</span></span> * <span class="mxinfo " id="T5:U99"><span class="var type1" id="S22T4U196">K</span>'</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19">19</a></span><span class="line">    <span class="mxinfo " id="T1:U101"><span class="var type1" id="S2T1U199"><span class="message error" id="M1F1C">xHat</span></span></span> = <span class="mxinfo " id="T8:U102"><span class="var type1" id="S20T8U201">xHat_kk1</span> + <span class="mxinfo " id="T8:U104"><span class="var type1" id="S22T4U203">K</span> * <span class="mxinfo " id="T3:U106">[<span class="var type1" id="S7T3U207">y</span> - <span class="mxinfo " id="T3:U108"><span class="var type1" id="S11T5U209">Cd</span> * <span class="var type1" id="S20T8U210">xHat_kk1</span></span>]</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20">20</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21">21</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22">22</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T7:U111"><span class="var type1" id="S4T1U214">t</span> &gt; <span class="mxinfo " id="T1:U113">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23">23</a></span><span class="line">    <span class="var type0" id="S20T0U218">xHat_kk1</span> = <span class="message error" id="M2F1C"><span class="mxinfo " id="T2:U114"><span class="var type1" id="S9T2U221">Ad</span> * <span class="var type1" id="S2T1U222">xHat</span></span> + <span class="mxinfo " id="T8:U117"><span class="var type1" id="S10T4U224">Bd</span> * <span class="var type1" id="S16T3U225">u</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24">24</a></span><span class="line">    <span class="mxinfo " id="T2:U120"><span class="var type1" id="S21T2U228">P_kk1</span> = <span class="mxinfo " id="T2:U122"><span class="mxinfo " id="T2:U123"><span class="mxinfo " id="T2:U124"><span class="mxinfo " id="T2:U125"><span class="mxinfo " id="T2:U126"><span class="var type1" id="S9T2U234">Ad</span> * <span class="var type1" id="S8T2U235">Pk</span></span> * <span class="mxinfo " id="T2:U129"><span class="var type1" id="S9T2U237">Ad</span>'</span></span> * <span class="var type1" id="S12T2U238">G</span></span> * <span class="var type1" id="S14T2U239">Z</span></span> * <span class="mxinfo " id="T2:U133"><span class="var type1" id="S12T2U241">G</span>'</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25">25</a></span><span class="line">    <span class="mxinfo " id="T4:U135"><span class="var type1" id="S22T4U244">K</span> = <span class="mxinfo " id="T4:U137"><span class="mxinfo " id="T4:U138"><span class="var type1" id="S21T2U247">P_kk1</span> * <span class="mxinfo " id="T4:U140"><span class="var type1" id="S11T5U249">Cd</span>'</span></span> * <span class="mxinfo " id="T6:U142">inv(<span class="mxinfo " id="T6:U143"><span class="mxinfo " id="T6:U144"><span class="mxinfo " id="T5:U145"><span class="var type1" id="S11T5U255">Cd</span> * <span class="var type1" id="S21T2U256">P_kk1</span></span> * <span class="mxinfo " id="T4:U148"><span class="var type1" id="S11T5U258">Cd</span>'</span></span> + <span class="var type1" id="S15T6U259">V</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26">26</a></span><span class="line">    <span class="mxinfo " id="T2:U151"><span class="var type1" id="S3T2U262">P</span> = <span class="mxinfo " id="T2:U153"><span class="mxinfo " id="T2:U154"><span class="mxinfo " id="T2:U155">(<span class="mxinfo " id="T2:U156"><span class="mxinfo " id="T2:U157">eye(4)</span> - <span class="mxinfo " id="T2:U158"><span class="var type1" id="S22T4U272">K</span> * <span class="var type1" id="S11T5U273">Cd</span></span></span>) * <span class="var type1" id="S21T2U274">P_kk1</span></span> * <span class="mxinfo " id="T2:U162">(<span class="mxinfo " id="T2:U163"><span class="mxinfo " id="T2:U164">eye(4)</span> - <span class="mxinfo " id="T2:U165"><span class="var type1" id="S22T4U282">K</span> * <span class="var type1" id="S11T5U283">Cd</span></span></span>)'</span></span> + <span class="mxinfo " id="T2:U168"><span class="mxinfo " id="T4:U169"><span class="var type1" id="S22T4U286">K</span> * <span class="var type1" id="S15T6U287">V</span></span> * <span class="mxinfo " id="T5:U172"><span class="var type1" id="S22T4U289">K</span>'</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27">27</a></span><span class="line">    <span class="var type1" id="S2T1U292">xHat</span> = <span class="var type0" id="S20T0U294"><span class="message error" id="M3F1C">xHat_kk1</span></span> + <span class="var type0" id="S22T0U296">K</span> * [<span class="var type0" id="S7T0U300">y</span> - <span class="var type0" id="S11T0U302">Cd</span> * <span class="var type0" id="S20T0U303">xHat_kk1</span>]</span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28">28</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29">29</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30">30</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31">31</a></span><span class="line"></span></span>
</pre>
</body>
</html>

<!-- saved from url=(0014)about:internet -->
<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="mxinfo " id="T1:U1"><span class="var type1" id="S2T1U3"><span class="message error" id="M1F1C">xHat</span></span></span>, <span class="var type1" id="S3T2U4">P</span>] = fcn(<span class="var type1" id="S4T3U7">t</span>, <span class="var type1" id="S5T3U8">u1</span>, <span class="var type1" id="S6T3U9">u2</span>, <span class="var type1" id="S7T4U10">y</span> , <span class="var type1" id="S8T1U11">xHat_k1</span>, <span class="var type1" id="S9T2U12">Pk</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line"><span class="mxinfo " id="T2:U9"><span class="var type1" id="S10T2U15">Ad</span> = <span class="mxinfo " id="T2:U11">[1 0 0.01 0; 0 1 0 0.01; 0 0 1 0; 0 0 0 1]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line"><span class="mxinfo " id="T5:U12"><span class="var type1" id="S11T5U39">Bd</span> = <span class="mxinfo " id="T5:U14">[0.0001 0;0 0.0001;0.01 0;0 0.01]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line"><span class="mxinfo " id="T6:U15"><span class="var type1" id="S12T6U55">Cd</span> = <span class="mxinfo " id="T6:U17">[1 0 0 0; 0 1 0 0]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line"><span class="mxinfo " id="T2:U18"><span class="var type1" id="S13T2U69">G</span> = <span class="mxinfo " id="T2:U20">zeros(<span class="mxinfo " id="T3:U21">4</span>,<span class="mxinfo " id="T3:U22">4</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line"><span class="mxinfo " id="T2:U23"><span class="var type1" id="S15T2U76">Z</span> = <span class="mxinfo " id="T2:U25">zeros(<span class="mxinfo " id="T3:U26">4</span>,<span class="mxinfo " id="T3:U27">4</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line"><span class="mxinfo " id="T7:U28"><span class="var type1" id="S16T7U83">V</span> = <span class="mxinfo " id="T7:U30">zeros(<span class="mxinfo " id="T3:U31">2</span>,<span class="mxinfo " id="T3:U32">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">10</a></span><span class="line"><span class="mxinfo " id="T4:U33"><span class="var type1" id="S17T4U90">u</span> = <span class="mxinfo " id="T4:U35">[<span class="var type1" id="S5T3U93">u1</span>;<span class="var type1" id="S6T3U95">u2</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">11</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">12</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T8:U38"><span class="var type1" id="S4T3U99">t</span> == <span class="mxinfo " id="T3:U40">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13">13</a></span><span class="line">  <span class="mxinfo " id="T1:U41"><span class="var type1" id="S18T1U103">x</span> = <span class="mxinfo " id="T1:U43">[pi/2; 0; 0; 0;]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14">14</a></span><span class="line">    <span class="mxinfo " id="T2:U44"><span class="var type1" id="S20T2U118">Pk0</span> = <span class="mxinfo " id="T2:U46"><span class="var type1" id="S18T1U120">x</span> * <span class="var type1" id="S18T1U122">x</span>'</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15">15</a></span><span class="line">    <span class="mxinfo " id="T1:U49"><span class="var type1" id="S21T1U125">xHat_kk1</span> = <span class="mxinfo " id="T1:U51"><span class="mxinfo " id="T1:U52"><span class="var type1" id="S10T2U128">Ad</span> * <span class="var type1" id="S18T1U129">x</span></span> + <span class="mxinfo " id="T1:U55"><span class="var type1" id="S11T5U131">Bd</span> * <span class="var type1" id="S17T4U132">u</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16">16</a></span><span class="line">    <span class="mxinfo " id="T2:U58"><span class="var type1" id="S22T2U135">P_kk1</span> = <span class="mxinfo " id="T2:U60"><span class="var type1" id="S10T2U139">Ad</span> * <span class="var type1" id="S20T2U140">Pk0</span> * <span class="var type1" id="S10T2U142">Ad</span>' + <span class="var type1" id="S13T2U145">G</span> * <span class="var type1" id="S15T2U146">Z</span> * <span class="var type1" id="S13T2U148">G</span>'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17">17</a></span><span class="line">    <span class="mxinfo " id="T5:U67"><span class="var type1" id="S23T5U151">K</span> = <span class="mxinfo " id="T5:U69"><span class="mxinfo " id="T5:U70"><span class="var type1" id="S22T2U154">P_kk1</span> * <span class="var type1" id="S12T6U156">Cd</span>'</span> * <span class="mxinfo " id="T7:U73">inv(<span class="var type1" id="S12T6U162">Cd</span> * <span class="var type1" id="S22T2U163">P_kk1</span> * <span class="var type1" id="S12T6U165">Cd</span>' + <span class="var type1" id="S16T7U166">V</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18">18</a></span><span class="line">    <span class="mxinfo " id="T2:U78"><span class="var type1" id="S3T2U169">P</span> = <span class="mxinfo " id="T2:U80"><span class="mxinfo " id="T2:U81"><span class="mxinfo " id="T2:U82">(<span class="mxinfo " id="T2:U83"><span class="mxinfo " id="T2:U84">eye(4)</span> - <span class="mxinfo " id="T2:U85"><span class="var type1" id="S23T5U179">K</span> * <span class="var type1" id="S12T6U180">Cd</span></span></span>) * <span class="var type1" id="S22T2U181">P_kk1</span></span> * <span class="mxinfo " id="T2:U89">(<span class="mxinfo " id="T2:U90"><span class="mxinfo " id="T2:U91">eye(4)</span> - <span class="mxinfo " id="T2:U92"><span class="var type1" id="S23T5U189">K</span> * <span class="var type1" id="S12T6U190">Cd</span></span></span>)'</span></span> + <span class="mxinfo " id="T2:U95"><span class="mxinfo " id="T5:U96"><span class="var type1" id="S23T5U193">K</span> * <span class="var type1" id="S16T7U194">V</span></span> * <span class="mxinfo " id="T6:U99"><span class="var type1" id="S23T5U196">K</span>'</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19">19</a></span><span class="line">    <span class="mxinfo " id="T1:U101"><span class="var type1" id="S2T1U199">xHat</span> = <span class="mxinfo " id="T1:U103"><span class="var type1" id="S21T1U201">xHat_kk1</span> + <span class="mxinfo " id="T1:U105"><span class="var type1" id="S23T5U203">K</span> * <span class="mxinfo " id="T4:U107">[<span class="var type1" id="S7T4U207">y</span> - <span class="mxinfo " id="T4:U109"><span class="var type1" id="S12T6U209">Cd</span> * <span class="var type1" id="S21T1U210">xHat_kk1</span></span>]</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20">20</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21">21</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22">22</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T8:U112"><span class="var type1" id="S4T3U214">t</span> &gt; <span class="mxinfo " id="T3:U114">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23">23</a></span><span class="line">    <span class="mxinfo " id="T1:U115"><span class="var type1" id="S21T1U218">xHat_kk1</span> = <span class="mxinfo " id="T1:U117"><span class="mxinfo " id="T1:U118"><span class="var type1" id="S10T2U221">Ad</span> * <span class="var type1" id="S8T1U222">xHat_k1</span></span> + <span class="mxinfo " id="T1:U121"><span class="var type1" id="S11T5U224">Bd</span> * <span class="var type1" id="S17T4U225">u</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24">24</a></span><span class="line">    <span class="mxinfo " id="T2:U124"><span class="var type1" id="S22T2U228">P_kk1</span> = <span class="mxinfo " id="T2:U126"><span class="mxinfo " id="T2:U127"><span class="mxinfo " id="T2:U128"><span class="mxinfo " id="T2:U129"><span class="mxinfo " id="T2:U130"><span class="var type1" id="S10T2U234">Ad</span> * <span class="var type1" id="S9T2U235">Pk</span></span> * <span class="mxinfo " id="T2:U133"><span class="var type1" id="S10T2U237">Ad</span>'</span></span> * <span class="var type1" id="S13T2U238">G</span></span> * <span class="var type1" id="S15T2U239">Z</span></span> * <span class="mxinfo " id="T2:U137"><span class="var type1" id="S13T2U241">G</span>'</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25">25</a></span><span class="line">    <span class="mxinfo " id="T5:U139"><span class="var type1" id="S23T5U244">K</span> = <span class="mxinfo " id="T5:U141"><span class="mxinfo " id="T5:U142"><span class="var type1" id="S22T2U247">P_kk1</span> * <span class="mxinfo " id="T5:U144"><span class="var type1" id="S12T6U249">Cd</span>'</span></span> * <span class="mxinfo " id="T7:U146">inv(<span class="mxinfo " id="T7:U147"><span class="mxinfo " id="T7:U148"><span class="mxinfo " id="T6:U149"><span class="var type1" id="S12T6U255">Cd</span> * <span class="var type1" id="S22T2U256">P_kk1</span></span> * <span class="mxinfo " id="T5:U152"><span class="var type1" id="S12T6U258">Cd</span>'</span></span> + <span class="var type1" id="S16T7U259">V</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26">26</a></span><span class="line">    <span class="mxinfo " id="T2:U155"><span class="var type1" id="S3T2U262">P</span> = <span class="mxinfo " id="T2:U157"><span class="mxinfo " id="T2:U158"><span class="mxinfo " id="T2:U159">(<span class="mxinfo " id="T2:U160"><span class="mxinfo " id="T2:U161">eye(4)</span> - <span class="mxinfo " id="T2:U162"><span class="var type1" id="S23T5U272">K</span> * <span class="var type1" id="S12T6U273">Cd</span></span></span>) * <span class="var type1" id="S22T2U274">P_kk1</span></span> * <span class="mxinfo " id="T2:U166">(<span class="mxinfo " id="T2:U167"><span class="mxinfo " id="T2:U168">eye(4)</span> - <span class="mxinfo " id="T2:U169"><span class="var type1" id="S23T5U282">K</span> * <span class="var type1" id="S12T6U283">Cd</span></span></span>)'</span></span> + <span class="mxinfo " id="T2:U172"><span class="mxinfo " id="T5:U173"><span class="var type1" id="S23T5U286">K</span> * <span class="var type1" id="S16T7U287">V</span></span> * <span class="mxinfo " id="T6:U176"><span class="var type1" id="S23T5U289">K</span>'</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27">27</a></span><span class="line">    <span class="mxinfo " id="T1:U178"><span class="var type1" id="S2T1U292">xHat</span> = <span class="mxinfo " id="T1:U180"><span class="var type1" id="S21T1U294">xHat_kk1</span> + <span class="mxinfo " id="T1:U182"><span class="var type1" id="S23T5U296">K</span> * <span class="mxinfo " id="T4:U184">[<span class="var type1" id="S7T4U300">y</span> - <span class="mxinfo " id="T4:U186"><span class="var type1" id="S12T6U302">Cd</span> * <span class="var type1" id="S21T1U303">xHat_kk1</span></span>]</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28">28</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29">29</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30">30</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31">31</a></span><span class="line"></span></span>
</pre>
</body>
</html>
